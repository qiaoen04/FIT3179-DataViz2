<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">

  <style>
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:#0b1e3a;               
    }
    .wrap {
  max-width: 1200px;              
  margin: 0 auto;                 
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24px;
  padding: 24px;
  align-items: start;              
  justify-content: center;         
}



    .full{grid-column:1 / -1}

    /* Cards */
    .card {
  background: #fff;
  border-radius: 12px;
  padding: 14px;
  box-shadow: 0 6px 24px rgba(0, 0, 0, 0.2);
  width: 100%;                    
  box-sizing: border-box;
}

.full {
  grid-column: 1 / -1;         
  width: 100%;                    
}
.wrap {
  grid-template-columns: 1fr 1fr;  
}

.wrap {
  align-items: stretch;  
}

.wrap > .card:nth-child(1),
.wrap > .card:nth-child(2) {
  display: flex;
  flex-direction: column;
  justify-content: space-between;  
  height: 100%;
}



    header{color:#fff;text-align:center;padding:28px 0 8px}
    h3{margin:6px 0 12px 4px;color:#0b1e3a}  
    .sub,.obs,.tip{color:#2b2b2b}


    #bar-view,
    #age-bmi-view {
      display: flex;
      justify-content: center;
    }

    #bar-view .vega-embed,
    #age-bmi-view .vega-embed {
      margin: 0 auto;
      max-width: 1120px;
      width: 100%;
    }

    #heatmap-view {
      display: flex;
      justify-content: flex-start; 
    }

    #heatmap-view .vega-embed {
      margin-left: 0;
      margin-right: auto;
      max-width: 1120px;
      width: 100%;
    }

    #bar-view .vega-embed,
    #heatmap-view .vega-embed,
    #age-bmi-view .vega-embed {
      margin: 0 auto;    
      max-width: 1120px;   
      width: 100%;      
    }

.heatmap-card .heatmap-grid {
  display: grid;
  grid-template-columns: 2fr 1fr; 
  gap: 24px;
  align-items: center;
}

.heatmap-card .chart-side {
  display: flex;
  flex-direction: column;
}

.heatmap-card .text-side {
  padding-top: 40px; 
}

.heatmap-card .text-side ul {
  margin-top: 14px;
}

.main-header {
  background: #0b1e3a;
}

.main-header .container {
  max-width: 1200px;   
  margin: 0 auto;      
  text-align: center;   
  padding: 40px 24px 20px;
}

.main-header h1 {
  margin: 0;
  font-size: 75px;       
  font-weight: 700;
  color: #fff;
  letter-spacing: 1px;
}

.main-header p {
  margin-top: 8px;
  font-size: 25px;
  color: #dce4f7;
}

.title-lg{
  font-size: 26px;    
  line-height: 1.2;
  margin: 6px 0 12px 4px; 
  font-weight: 700;
}

.heatmap-card .text-side {
  font-size: 22px;           
  line-height: 1.6;           
}


.heatmap-card .text-side .obs li {
  font-size: 22px;           
  margin-bottom: 10px;       
}

.sub, .tip, .obs li {
  font-size: 22px;       
  line-height: 1.7;      
  color: #222;           
}

.tip {
  font-weight: 600;
  color: #0b1e3a;
}

.obs {
  margin-top: 10px;
  padding-left: 24px;
}

.obs li {
  margin-bottom: 10px;
}


.card h3 {
  font-size: 30px;      
  line-height: 1.25;
  font-weight: 800;
  margin: 6px 0 12px 4px; 
  color: #0b1e3a;          
}

@media (max-width: 700px) {
  .card h3 { font-size: 24px; }
}

.wrap {
  padding: 32px 40px;   
  gap: 28px;            
}

.card {
  padding: 22px 28px;  
  border-radius: 14px;
}

.card h3,
.card .sub,
.card .tip,
.card .obs {
  margin-left: 2px;     
}

.card ul {
  padding-left: 24px;   
  margin-top: 10px;
}

.heatmap-card .text-side {
  padding: 8px 12px 8px 18px;
}

.card .vega-embed {
  margin-top: 6px;
}
/* Main page title */
.main-header h1{
  font-family: 'Bungee', 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  font-weight: 400;              
  font-size: clamp(48px, 8vw, 88px);
  letter-spacing: 1px;
}

.card h3 {
    font-family: 'Oswald', 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    font-weight: 700; 
    letter-spacing: 0.2px; 
  }



/* ====== FILTER / DROPDOWN STYLING ====== */
.controls label,
.controls select {
  font-size: 20px;          
  font-family: 'Poppins', sans-serif;
  color: #0b1e3a;
}

.controls select {
  padding: 10px 16px;       
  border: 2px solid #0b1e3a;
  border-radius: 8px;
  background-color: #f9f9f9;
  font-size: 18px;
  font-weight: 600;
  color: #0b1e3a;
  cursor: pointer;
  transition: all 0.2s ease;
  outline: none;
}

.controls select:hover {
  background-color: #e6eefc;
}

.controls select:focus {
  border-color: #1d4ed8;
  box-shadow: 0 0 0 3px rgba(29, 78, 216, 0.25);
}

.controls {
  margin-top: 12px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 10px;                 
}


.vega-bind-name {
  font-size: 20px !important;
  font-weight: 600;
  color: #0b1e3a;
  margin-right: 10px;
}
.vega-bind select {
  font-size: 18px !important;
  padding: 8px 14px;
  border-radius: 8px;
  border: 2px solid #0b1e3a;
  background-color: #f9f9f9;
}

.vg-tooltip {
  font-size: 16px !important;
  font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif !important;
  line-height: 1.4;
}

.main-header h1 {
  font-family: 'Bungee', 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  font-weight: 400;
  font-size: clamp(48px, 6vw, 70px);  
  letter-spacing: 1px;
  white-space: nowrap;               
  text-align: center;               
}

.card.meta{
  background:#0b1e3a; color:#fff; box-shadow:none; border:none;
  padding:22px 28px;
}

/* Row 1: two columns (Author | Date) */
.meta-head{
  display:grid; grid-template-columns:1fr auto; gap:24px; align-items:start;
  margin-bottom:12px; border-bottom:1px solid rgba(255,255,255,.12); padding-bottom:12px;
}
.meta-right{ text-align:right; }

/* Row 2: full-width sources */
.meta-body h3{ margin:10px 0 8px; }
.meta-item h3{ margin:0 0 6px; }
.meta-item p{ margin:0; }

/* Footer / metadata card */
.card.meta{
  background: #0b1e3a;   /* same as page bg */
  color: #fff;
  box-shadow: none;
  border-radius: 12px;
  padding: 28px 32px;
  font-size: 20px;
  line-height: 1.7;
}

/* Two-column head: Author | Date */
.meta-head{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  margin-bottom: 18px;
  align-items: start;
}

.card.meta h3{
  color: #fff;
  font-size: 28px;
  font-weight: 800;
  margin: 0 0 8px;
  letter-spacing: .2px;
}

.card.meta p{ margin: 0; font-size: 20px; }

.meta-body ul{
  margin: 6px 0 0;
  padding-left: 22px;
}

.meta-body li{
  margin: 6px 0;
  font-size: 20px;
}

.card.meta a{
  color: #e6eefc;
  text-decoration: underline;
  word-break: break-word;
  font-size: 20px;
}

/* Stack nicely on small screens */
@media (max-width: 700px){
  .meta-head{ grid-template-columns: 1fr; }
  .card.meta{ font-size: 18px; padding: 24px; }
  .card.meta h3{ font-size: 24px; }
  .card.meta a, .card.meta p, .meta-body li{ font-size: 18px; }
}

  </style>

</head>
<body>
  
<!-- MAIN PAGE TITLE -->
<header class="main-header">
  <div class="container">
    <h1>Olympic Through The Years</h1>
    <p>How games and athletes evolved through the years.</p>
  </div>
</header>

<div class="wrap">

  <!-- MAP (left) -->
  <div class="card">
    <h3>Global Medal Landscape - Where Do the Medals Live?</h3>
    <div id="map-view"></div>
    <ul class="obs">
      <li>The United States consistently achieving the highest normalized medal scores across modern Olympic history.</li>
      <li>Europe & North America dominate, with strong pockets in East Asia/Oceania.</li>
      <li>Lighter tones show smaller or newer NOCs.</li>
    </ul>
  </div>


  <!-- DONUT (right) -->
  <div class="card">
    <h3>Gold-Silver-Bronze Split</h3>
    <p class="sub">Pick a country to see its medal composition.</p>
    <div id="donut-view"></div>
    <div id="donut-controls" class="controls"></div>
    <p class="tip">Tip: Try USA, China, or Norway for contrasts.</p>
    <ul class="obs">
      <li>USA and China lead with a high gold ratio, showing dominance.</li>
      <li>HEmerging nations earn more silver and bronze, signaling growing strength.</li>
      <li>Norway and Japan display balanced mixes, reflecting versatility.</li>
    </ul>
  </div>


  <!-- BAR (bottom, full width) -->
  <div class="card full">
    <h3>How Athlete Participation Grew</h3>
    <p class="sub">Summer = stacked bars; Winter = lines. Use the selector to focus.</p>
    <div id="bar-view"></div>
    <div id="bar-controls" class="controls"></div>
    <ul class="obs">
      <li>Sharp growth post mid-20th century.</li>
      <li>Women's share rises steadily.</li>
      <li>Winter is lower overall but trends similarly.</li>
    </ul>
  </div>


<!-- HEATMAP (bottom, full width) -->
<div class="card full heatmap-card">
  <div class="heatmap-grid">
    <div class="chart-side">
      <h3>Specialisations by Nation</h3>
      <p class="sub">Darker cells = more medals for that country-sport pair.</p>
      <div id="heatmap-view"></div>
    </div>

    <div class="text-side">
      <p class="tip">Hover cells to compare focus vs overall totals.</p>
      <ul class="obs">
        <li><strong>Russia, Germany</strong> and the <strong>Soviet Union</strong>show consistently dark cells across many sports, reflecting broad sporting strength.</li>
        <li><strong>China</strong> and <strong>Japan</strong> have strong specialisations in gymnastics, diving, and table tennis.</li>
        <li><strong></strong>Nordic countries like <strong>Norway</strong> and <strong>Sweden</strong> concentrate their medals in winter sports such as skiing and ice hockey.</li>
      </ul>
    </div>
  </div>
</div>


<!-- AGE & BMI (full width) -->
<div class="card full">
  <h3>Who Reaches the Podium?</h3>
  <p class="sub">Distribution of Age and BMI among medal winners.</p>
  <div id="age-bmi-view"></div>
  <ul class="obs">
    <li>Median ages across medal types are similar; extremes are rare.</li>
    <li>BMI spans widely, reflecting sport diversity.</li>
    <li>Gold distributions are tighter-peak performance bands.</li>
  </ul>
</div>

<!-- Footer metadata card -->
<div class="card full meta">
  <div class="meta-head">
    <div class="meta-item">
      <h3>Author</h3>
      <p>Lim Qiao En</p>
    </div>
    <div class="meta-item meta-right">
      <h3>Date</h3>
      <p>Last updated: <span id="last-updated"></span></p>
    </div>
  </div>

  <div class="meta-body">
    <h3>Data Sources</h3>
    <ul>
      <li>
        <a href="https://www.kaggle.com/datasets/mysarahmadbhat/120-years-of-olympic-history" target="_blank" rel="noopener noreferrer">
          Kaggle: 120 Years of Olympic History
        </a>
      </li>
      <li>
        <a href="https://worldpopulationreview.com/country-rankings/olympic-medals-by-country" target="_blank" rel="noopener noreferrer">
          WorldPopulationReview: Medals by Country
        </a>
      </li>
    </ul>
  </div>
</div>

<script>
  // Auto-fill "Last updated" if empty (e.g., today)
  const el = document.getElementById('last-updated');
  if (el && !el.textContent.trim()) {
    el.textContent = new Date().toLocaleDateString(undefined, {
      year: 'numeric', month: 'short', day: 'numeric'
    });
  }
</script>





<script>
  // ---------- MAP (choropleth) ----------
const mapSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {"text":"Olympic Medals (Normalized by Top Country)","fontSize":28,"dy": -10 },
  
  "width": 900,
  "height": 550,
  "fontSize": 28, 
  "projection": {"type": "equalEarth"},
  "layer": [
    { 
      "data": {"sphere": true},
      "mark": {"type": "geoshape", "fill": "#eef6fb", "stroke": null}
    },
    { 
      "data": {"graticule": true},
      "mark": {"type": "geoshape", "stroke": "#c7d2d9", "strokeWidth": 0.5}
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/3_choropleth_map/js/ne_110m_admin_0_countries.topojson",
        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
      },
      "mark": {"type": "geoshape", "fill": "#f2efe9", "stroke": "#ffffff", "strokeWidth": 0.3}
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/3_choropleth_map/js/ne_110m_admin_0_countries.topojson",
        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
      },
      "transform": [
        {
          "lookup": "properties.NAME",
          "from": {
            "data": {"url": "https://raw.githubusercontent.com/qiaoen04/FIT3179-DataViz2/main/olympic.csv"},
            "key": "country",
            "fields": ["OlympicMedalsTotal_2022", "OlympicMedalsGold", "OlympicMedalsSilver", "OlympicMedalsBronze"]
          }
        },
        {"calculate": "toNumber(datum.OlympicMedalsTotal_2022)", "as": "Medals"},
        {"calculate": "datum.Medals / 3105", "as": "MedalsNormalized"} 
      ],
      "mark": {"type": "geoshape", "stroke": "#ffffff", "strokeWidth": 0.3},
      "encoding": {
        "color": {
          "field": "MedalsNormalized",
          "type": "quantitative",
          "scale": {"type": "linear", "domain": [0, 1]},
          "legend": {"title": "Normalized Medal Score", "orient": "right"}
        },
        "tooltip": [
          {"field": "properties.NAME", "type": "nominal", "title": "Country"},
          {"field": "Medals", "type": "quantitative", "title": "Total"},
          {"field": "OlympicMedalsGold", "type": "quantitative", "title": "Gold"},
          {"field": "OlympicMedalsSilver", "type": "quantitative", "title": "Silver"},
          {"field": "OlympicMedalsBronze", "type": "quantitative", "title": "Bronze"},
          {"field": "MedalsNormalized", "type": "quantitative", "title": "Normalized (0-1)"}
        ]
      }
    }
  ]
};


    // ---------- DONUT (country picker under chart) ----------
const donutSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {"text": "Medal Mix by Country", "fontSize": 28},
  "width": 500,
  "height": 350,
  "fontSize": 28, 
  "background": "transparent",                 
  "config": { "view": { "stroke": "transparent" } } ,
  "data": {
    "url": "https://raw.githubusercontent.com/qiaoen04/FIT3179-DataViz2/main/olympic.csv"
  },

  "params": [
    {
      "name": "country_sel",
      "value": "United States of America",
      "bind": {
        "input": "select",
        "name": " Country: ",
        "options": [
          "Afghanistan","Algeria","Andorra","Argentina","Armenia","Australia","Austria", "Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium", "Bermuda","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil", "Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Chile", "China","Colombia","Costa Rica","Croatia","Cuba","Cyprus","Czechia","Denmark", "Djibouti","Dominican Republic","Ecuador","Egypt","El Salvador","Eritrea", "Estonia","Ethiopia","Fiji","Finland","France","Gabon","Georgia","Germany", "Ghana","Greece","Grenada","Guatemala","Guyana","Haiti","Hong Kong S.A.R", "Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy", "Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kuwait","Kyrgyzstan","Latvia", "Lebanon","Liechtenstein","Lithuania","Luxembourg","Malaysia","Mexico","Moldova", "Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia", "Nauru","Netherlands","New Zealand","Nigeria","North Korea","North Macedonia", "Norway","Pakistan","Panama","Paraguay","Peru","Philippines","Poland","Portugal", "Puerto Rico","Qatar","Romania","Russia","San Marino","Saudi Arabia","Senegal", "Serbia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain", "Sri Lanka","Suriname","Sweden","Switzerland","Syria","Taiwan","Tajikistan", "Tanzania","Thailand","Togo","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan", "Uganda","Ukraine","United Arab Emirates","United Kingdom","United States of America", "Uruguay","Uzbekistan","Venezuela","Vietnam","Zambia","Zimbabwe"
        ],
        "element": "#donut-controls"
      }
    }
  ],

  "transform": [
    {"filter": "datum.country && datum.country != 'Total'"},
    {
      "fold": [
        "OlympicMedalsGold",
        "OlympicMedalsSilver",
        "OlympicMedalsBronze"
      ],
      "as": ["MedalType", "Count"]
    },
    {
      "calculate":
        "datum.MedalType == 'OlympicMedalsGold' ? 'Gold' : datum.MedalType == 'OlympicMedalsSilver' ? 'Silver' : 'Bronze'",
      "as": "Medal"
    },
    {
      "aggregate": [{"op": "sum", "field": "Count", "as": "Count"}],
      "groupby": ["country", "Medal"]
    }
  ],

  "layer": [
    /* Donut slices */
    {
      "transform": [{"filter": "datum.country == country_sel"}],
      "mark": {"type": "arc", "innerRadius": 90, "outerRadius": 150},
      "encoding": {
        "theta": {"field": "Count", "type": "quantitative"},
        "color": {
          "field": "Medal",
          "type": "nominal",
          "sort": ["Gold", "Silver", "Bronze"],
          "scale": {"range": ["#d4af37", "#c0c0c0", "#cd7f32"]},
          "title": "Medal Type"
        },
        "tooltip": [
          {"field": "country", "title": "Country"},
          {"field": "Medal", "title": "Medal"},
          {"field": "Count", "title": "Medals"}
        ]
      }
    },

    /* Country name in center */
    {
      "transform": [
        {"filter": "datum.country == country_sel"},
        {"aggregate": [{"op": "max", "field": "country", "as": "cc"}]}
      ],
      "mark": {"type": "text", "fontSize": 16, "fontWeight": "bold", "align": "center"},
      "encoding": {
        "x": {"value": 250},
        "y": {"value": 340},
        "text": {"field": "cc"},
        "color": {"value": "#111"}
      }
    },

    /* Gold: xxx */
    {
      "transform": [
        {"filter": "datum.country == country_sel && datum.Medal == 'Gold'"},
        {"calculate": "'Gold: ' + format(datum.Count, ',d')", "as": "label"}
      ],
      "mark": {"type": "text", "fontSize": 12, "align": "center", "baseline": "middle"},
      "encoding": {
        "x": {"value": 250},
        "y": {"value": 160},
        "text": {"field": "label"},
        "color": {"value": "#d4af37"}
      }
    },

    /* Silver: xxx */
    {
      "transform": [
        {"filter": "datum.country == country_sel && datum.Medal == 'Silver'"},
        {"calculate": "'Silver: ' + format(datum.Count, ',d')", "as": "label"}
      ],
      "mark": {"type": "text", "fontSize": 12, "align": "center", "baseline": "middle"},
      "encoding": {
        "x": {"value": 250},
        "y": {"value": 180},
        "text": {"field": "label"},
        "color": {"value": "#9a9a9a"}
      }
    },

    /* Bronze: xxx */
    {
      "transform": [
        {"filter": "datum.country == country_sel && datum.Medal == 'Bronze'"},
        {"calculate": "'Bronze: ' + format(datum.Count, ',d')", "as": "label"}
      ],
      "mark": {"type": "text", "fontSize": 12, "align": "center", "baseline": "middle"},
      "encoding": {
        "x": {"value": 250},
        "y": {"value": 200},
        "text": {"field": "label"},
        "color": {"value": "#cd7f32"}
      }
    }
  ]
};

  // ---------- BAR (Season picker under chart) ----------
  const barSpec = {
    "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
    "title": {"text":"Participation - Summer (Stacked Bars) + Winter (Lines)","fontSize": 28 },
    "width": 1500,
    "height": 600,
    "fontSize": 28, 
    "data": {
      "url": "https://raw.githubusercontent.com/qiaoen04/FIT3179-DataViz2/main/athlete_events.csv",
      "format": {"type": "csv"}
    },
    "params":[
      {
        "name":"season_selection",
        "value": null,
        "bind":{
          "input":"select",
          "options":[null,"Summer","Winter"],
          "labels":["- All seasons -","Summer","Winter"],
          "name":"Season: ",
          "element":"#bar-controls"
        }
      }
    ],
    "transform": [
      {"filter": "isValid(datum.Year) && datum.Sex != null && datum.Season != null"},
      {"aggregate": [{"op":"count","as":"Entries"}], "groupby": ["Year","Sex","Season"]}
    ],
    "encoding": {
      "x": {"field": "Year", "type": "quantitative", "axis": {"format": "d", "title": "Year"}},
      "color": {
        "field": "Sex",
        "type": "nominal",
        "scale": {"domain": ["F", "M"], "range": ["#f0add5", "#8bc8f0"]},
        "legend": {"title": "Sex", "orient": "right", "direction": "vertical", "titleFontSize": 12, "labelFontSize": 11, "symbolType": "circle", "offset": 10}
      }
    },
    "layer": [
      {
        "name": "Summer (stacked bars)",
        "transform": [{"filter": "datum.Season == 'Summer'"}],
        "mark": {"type": "bar"},
        "encoding": {
          "y": {"field": "Entries", "type": "quantitative", "title": "Entries"},
          "size": {"value": 25},
          "opacity": {"condition": {"test": "season_selection == null || season_selection == 'Summer'", "value": 0.9}, "value": 0},
          "tooltip": [
            {"field":"Year","type":"quantitative","format":"d","title":"Year"},
            {"field":"Season","type":"nominal","title":"Season"},
            {"field":"Sex","type":"nominal"},
            {"field":"Entries","type":"quantitative","format":",","title":"Entries"}
          ]
        }
      },
      {
        "name": "Winter (lines)",
        "transform": [{"filter": "datum.Season == 'Winter'"}],
        "mark": {"type": "line", "point": {"filled": true, "size": 80, "fill": "#004c91"}, "strokeWidth": 2},
        "encoding": {
          "y": {"field": "Entries", "type": "quantitative"},
          "opacity": {"condition": {"test": "season_selection == null || season_selection == 'Winter'", "value": 1}, "value": 0},
          "tooltip": [
            {"field":"Year","type":"quantitative","format":"d","title":"Year"},
            {"field":"Season","type":"nominal","title":"Season"},
            {"field":"Sex","type":"nominal"},
            {"field":"Entries","type":"quantitative","format":",","title":"Entries"}
          ]
        }
      },
      {
      "name": "Winter points",
      "transform": [{"filter": "datum.Season == 'Winter'"}],
      "mark": {
        "type": "point",
        "size": 80,
        "filled": true
      },
      "encoding": {
        "y": {"field": "Entries", "type": "quantitative"},
        "color": {
          "field": "Sex",
          "type": "nominal",
          "scale": {"domain": ["F", "M"], "range": ["#d74c8a", "#004c91"]} 
        },
        "opacity": {
          "condition": {"test": "season_selection == null || season_selection == 'Winter'", "value": 1},
          "value": 0
        }
      }
    },
      {
        "name": "Summer total labels (all years)",
        "transform": [
          {"filter": "datum.Season == 'Summer'"},
          {"aggregate": [{"op": "sum", "field": "Entries", "as": "Total"}], "groupby": ["Year"]}
        ],
        "mark": {"type": "text", "dy": -6, "fontSize": 11, "stroke": "black", "strokeWidth": 1},
        "encoding": {
          "x": {"field": "Year", "type": "quantitative"},
          "y": {"field": "Total", "type": "quantitative"},
          "text": {"field": "Total", "type": "quantitative", "format": ",d"},
          "opacity": {"condition": {"test": "season_selection == null || season_selection == 'Summer'", "value": 1}, "value": 0},
          "tooltip": [
            {"field": "Year", "type": "quantitative", "format": "d", "title": "Year"},
            {"field": "Total", "type": "quantitative", "format": ",d", "title": "Summer total"}
          ]
        }
      }
    ]
  };

const heatMapSpec = {
  "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
  "title": { "text": "Total Medals by Sport and Country (Top 20 Countries)", "fontSize": 28 },

  "width": 1050,           
  "height": 520,          
  "fontSize": 28, 

  "data": { "url": "https://raw.githubusercontent.com/qiaoen04/FIT3179-DataViz2/refs/heads/main/top21_country_20sport_medals.csv" },
  "mark": "rect",

  "encoding": {
    "x": {
      "field": "Sport", "type": "nominal", "title": "Sport",
      "axis": { "labelAngle": -45 }     
    },
    "y": {
      "field": "Team", "type": "nominal", "title": "Country",
      "sort": {"field": "Country_Total", "op": "max", "order": "descending"}
    },
    "color": {
      "field": "Total_Medals", "type": "quantitative",
      "title": "Total Medals", "scale": {"scheme": "goldred"}
    },
    "tooltip": [
      {"field": "Team", "title": "Country"},
      {"field": "Sport", "title": "Sport"},
      {"field": "Total_Medals", "title": "Total Medals"},
      {"field": "Country_Total", "title": "Country Total"}
    ]
  },

  "config": {
    "axis": { "labelFontSize": 14, "titleFontSize": 16 },
    "legend": { "labelFontSize": 14, "titleFontSize": 15 },
    "title": { "fontSize": 22 },
    "view": { "stroke": "transparent" }
  }
};


  // ---------- AGE & BMI BOXPLOTS (full width) ----------
const ageBmiSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {"text":"Age and BMI Distribution by Medal Type","fontSize": 28 },
  
  "data": {
    "url": "https://raw.githubusercontent.com/qiaoen04/FIT3179-DataViz2/main/athletes_with_bmi.csv"
  },
  "transform": [
    {"filter": "datum.Medal != null && datum.Medal != 'NA'"},
    {
      
      "calculate": "datum.Weight / ((datum.Height/100)*(datum.Height/100))",
      "as": "BMI"
    }
  ],
  "hconcat": [
    {
      "mark": {"type": "boxplot", "size": 70},
      "width": 700,
      "height": 360,
      "encoding": {
        "x": {"field": "Medal", "type": "nominal", "title": "Medal Type", "sort": ["Gold","Silver","Bronze"]},
        "y": {"field": "Age", "type": "quantitative", "title": "Age"},
        "color": {
          "field": "Medal", "type": "nominal",
          "scale": {"domain": ["Gold","Silver","Bronze"], "range": ["#FFD700","#C0C0C0","#CD7F32"]},
          "title": "Medal Type"
        },
        "tooltip": [{"field":"Medal","title":"Medal Type"},{"field":"Age","title":"Age"}]
      }
    },
    {
      "mark": {"type": "boxplot", "size": 70},
      "width": 700,
      "height": 360,
      "encoding": {
        "x": {"field": "Medal", "type": "nominal", "title": "Medal Type", "sort": ["Gold","Silver","Bronze"]},
        "y": {"field": "BMI", "type": "quantitative", "title": "BMI"},
        "color": {
          "field": "Medal", "type": "nominal",
          "scale": {"domain": ["Gold","Silver","Bronze"], "range": ["#FFD700","#C0C0C0","#CD7F32"]},
          "legend": null
        },
        "tooltip": [{"field":"Medal","title":"Medal Type"},{"field":"BMI","title":"BMI"}]
      }
    }
  ],
  "spacing":100,
  "resolve": {
    "scale": {"color": "independent"},
    "legend": {"color": "independent"}
  }
};

  vegaEmbed("#map-view", mapSpec, {actions:false});
  vegaEmbed("#donut-view", donutSpec, {actions:false});
  vegaEmbed("#bar-view", barSpec, {actions:false});
  vegaEmbed("#heatmap-view", heatMapSpec, {actions:false});
  vegaEmbed("#age-bmi-view", ageBmiSpec, {actions:false});

</script>
</body>
</html>
